import { Injectable } from '@angular/core';
import { LocaleService } from './locale.service';

type Dictionary = Record<string, string>;

@Injectable({
  providedIn: 'root'
})
export class I18nService {
  private readonly bodyPartMk: Record<string, string> = {
    chest: 'Гради',
    back: 'Грб',
    shoulders: 'Раменици',
    biceps: 'Бицепс',
    triceps: 'Трицепс',
    arms: 'Раце',
    forearms: 'Подлактици',
    legs: 'Нозе',
    quads: 'Квадрицепс',
    hamstrings: 'Задна ложа',
    glutes: 'Глутеус',
    calves: 'Листови',
    abs: 'Стомачни',
    core: 'Центар',
    fullbody: 'Цело тело',
    'full body': 'Цело тело',
    cardio: 'Кардио',
    neck: 'Врат',
    traps: 'Трапез',
    adductors: 'Аддуктори',
    abductors: 'Абдуктори',
    lats: 'Латисимус',
    obliques: 'Коси стомачни'
  };

  private readonly en: Dictionary = {
    'nav.dashboard': 'Dashboard',
    'nav.workouts': 'Workouts',
    'nav.progress': 'Progress',
    'nav.profile': 'My Profile',
    'nav.theme.light': 'Light Mode',
    'nav.theme.dark': 'Dark Mode',
    'nav.logout': 'Logout',
    'nav.login': 'Login',
    'nav.signup': 'Sign Up',
    'nav.user.fallback': 'User',

    'main.hero.title.line1': 'Track Your Progress,',
    'main.hero.title.line2': 'Transform Your Body',
    'main.hero.subtitle': 'The ultimate gym logging app to monitor your workouts, track your gains, and achieve your fitness goals.',
    'main.hero.cta.start': 'Get Started',
    'main.hero.cta.more': 'Learn More',
    'main.features.title': 'Why Choose Our App?',
    'main.features.subtitle': 'Everything you need to succeed in your fitness journey',
    'main.feature.logging.title': 'Workout Logging',
    'main.feature.logging.desc': 'Easily log your workouts, track exercises, sets, reps, and weights. Never forget what you did in the gym.',
    'main.feature.progress.title': 'Progress Tracking',
    'main.feature.progress.desc': 'Visualize your progress with charts and statistics. See your strength gains and improvements over time.',
    'main.feature.plans.title': 'Workout Plans',
    'main.feature.plans.desc': 'Create and follow custom workout plans tailored to your goals. Stay consistent and motivated.',
    'main.feature.records.title': 'Personal Records',
    'main.feature.records.desc': 'Track your personal bests and celebrate milestones. Push yourself to beat your records.',
    'main.feature.secure.title': 'Secure & Private',
    'main.feature.secure.desc': 'Your data is secure with enterprise-grade authentication. Your progress is yours alone.',
    'main.feature.cross.title': 'Cross-Platform',
    'main.feature.cross.desc': 'Access your workout data anywhere, anytime. Works seamlessly on all your devices.',
    'main.cta.title': 'Ready to Start Your Fitness Journey?',
    'main.cta.subtitle': 'Join thousands of users who are already tracking their progress and achieving their goals.',
    'main.cta.button': 'Start Logging Now',
    'main.footer': 'Gym Logging App. Built with Angular & .NET',

    'dashboard.kicker': 'Performance Center',
    'dashboard.title': 'Dashboard',
    'dashboard.subtitle': 'See your totals, spotlight exercises, and recent sessions in one place.',
    'common.timeRange': 'Time Range',
    'common.retry': 'Retry',
    'dashboard.loading': 'Loading dashboard...',
    'dashboard.recent.title': 'Recent Workouts',
    'dashboard.seeAll': 'See all',
    'dashboard.recent.empty': 'No workouts yet.',
    'dashboard.recent.first': 'Create your first workout',
    'dashboard.open': 'Open',
    'dashboard.snapshot.title': 'Performance Snapshot',
    'dashboard.avgRepsSet': 'Avg Reps / Set',
    'dashboard.avgSetsWorkout': 'Avg Sets / Workout',
    'dashboard.consistency': 'Consistency Score',
    'dashboard.activeDays': '{count} active days',
    'dashboard.openWorkouts': 'Open Workouts',
    'dashboard.viewProgress': 'View Progress',

    'progress.kicker': 'Training Analytics',
    'progress.title': 'Progress',
    'progress.subtitle': 'Track consistency, body-part focus, and long-term momentum.',
    'progress.loading': 'Loading progress analytics...',
    'progress.totalWorkouts': 'Total Workouts',
    'progress.totalSets': 'Total Sets',
    'progress.totalReps': 'Total Reps',
    'progress.setsPerDay': 'Sets Per Day',
    'progress.lastTrackedDays': 'Last {count} tracked days',
    'progress.avgSetsWorkout': 'Avg sets/workout: {value}',
    'progress.emptyFrequency': 'No frequency data yet.',
    'progress.bodyPartDistribution': 'Body Part Distribution',
    'progress.emptyDistribution': 'No distribution data yet.',
    'progress.bodyPartVolume': 'Body Part Set Volume',
    'progress.trackedSets': 'Tracked sets across all body groups: {count}',
    'progress.emptyBodyPart': 'No body-part progress data yet.',
    'progress.setsLogged': '{count} sets',
    'progress.trackedShare': '{count}% of all tracked sets',

    'workouts.kicker': 'Session Manager',
    'workouts.title': 'Workouts',
    'workouts.subtitle': 'Track, filter, duplicate, and organize your training sessions.',
    'workouts.new': 'New Workout',
    'common.dismiss': 'Dismiss',
    'common.loading': 'Loading...',
    'workouts.loading': 'Loading workouts...',
    'workouts.empty.title': 'No workouts found',
    'workouts.empty.all': 'Start by creating a new workout.',
    'workouts.empty.filtered': 'No workouts in this period. Try another filter.',
    'workouts.empty.create': 'Create Your First Workout',
    'workouts.card.view': 'Click to view details',
    'workouts.copy': 'Copy',
    'pagination.prev': 'Previous',
    'pagination.next': 'Next',
    'pagination.meta': 'Page {current} of {total} - Total: {count} workouts',
    'workouts.create.title': 'Create New Workout',
    'workouts.field.title': 'Workout Title',
    'workouts.field.title.placeholder': 'e.g., Push Day, Leg Day',
    'common.date': 'Date',
    'common.cancel': 'Cancel',
    'workouts.create.action': 'Create Workout',
    'workouts.delete.title': 'Delete Workout',
    'workouts.delete.message': 'Are you sure you want to delete this workout? All exercises and sets will be permanently removed.',

    'workoutDetail.back': 'Back to Workouts',
    'workoutDetail.kicker': 'Workout Session',
    'workoutDetail.exercisesCount': '{count} exercises',
    'workoutDetail.editWorkout': 'Edit Workout',
    'workoutDetail.expandAll': 'Expand All',
    'workoutDetail.collapseAll': 'Collapse All',
    'workoutDetail.addExercise': 'Add Exercise',
    'workoutDetail.loading': 'Loading workout details...',
    'workoutDetail.empty.title': 'No exercises added yet',
    'workoutDetail.empty.desc': 'Add your first exercise to start tracking sets.',
    'workoutDetail.setsLogged': '{count} set{suffix} logged',
    'workoutDetail.dragHint': 'Drag to reorder',
    'workoutDetail.expandExercise': 'Expand exercise',
    'workoutDetail.collapseExercise': 'Collapse exercise',
    'workoutDetail.removeExercise': 'Remove exercise',
    'workoutDetail.table.set': 'Set',
    'workoutDetail.table.reps': 'Reps',
    'workoutDetail.table.weight': 'Weight (kg)',
    'workoutDetail.table.actions': 'Actions',
    'workoutDetail.placeholder.reps': 'Reps',
    'workoutDetail.placeholder.weight': 'Weight',
    'workoutDetail.editSet': 'Edit set',
    'workoutDetail.deleteSet': 'Delete set',
    'workoutDetail.save': 'Save',
    'workoutDetail.addSet': 'Add Set',
    'workoutDetail.searchExercise': 'Search Exercise',
    'workoutDetail.searchPlaceholder': 'Type to search exercises...',
    'workoutDetail.searching': 'Searching...',
    'workoutDetail.results': '{count} results',
    'workoutDetail.noResults': 'No exercises match your search.',
    'workoutDetail.edit.title': 'Edit Workout',
    'workoutDetail.saveChanges': 'Save Changes',
    'workoutDetail.removeExerciseTitle': 'Remove Exercise',
    'workoutDetail.removeExerciseMessage': 'Are you sure you want to remove this exercise from the workout?',
    'workoutDetail.deleteSetTitle': 'Delete Set',
    'workoutDetail.deleteSetMessage': 'Are you sure you want to delete this set?',
    'workoutDetail.setLabel': 'Set {number}',

    'confirm.selected': 'Selected',
    'confirm.cannotUndo': 'This action cannot be undone.',
    'confirm.delete': 'Delete',
    'confirm.deleting': 'Deleting...',
    'confirm.defaultTitle': 'Confirm Delete',
    'confirm.defaultMessage': 'Are you sure you want to delete this item?',

    'notFound.kicker': 'Error 404',
    'notFound.title': 'Page Not Found',
    'notFound.desc': 'The page you requested does not exist or has been moved.',
    'notFound.cta': 'Go to Dashboard',

    'logout.kicker': 'Session',
    'logout.title': 'You Have Been Logged Out',
    'logout.desc': 'Your session ended successfully. You can sign in again anytime.',
    'logout.cta': 'Return to App',

    'range.allTime': 'All Time',
    'range.last7': 'Last 7 Days',
    'range.last14': 'Last 14 Days',
    'range.last30': 'Last 30 Days',

    'error.dashboardLoad': 'Could not load dashboard data. Try again in a moment.',
    'error.progressLoad': 'Could not load progress analytics. Try again in a moment.',
    'error.workoutsLoad': 'Failed to load workouts. Please try again.',
    'error.filteredWorkoutsLoad': 'Failed to load workouts. Please try again.',
    'error.workoutCreate': 'Failed to create workout. Please try again.',
    'error.workoutDelete': 'Failed to delete workout. Please try again.',
    'error.workoutCopy': 'Failed to copy workout. Please try again.',
    'error.workoutDetails': 'Failed to load workout details. Please try again.',
    'error.exerciseAdd': 'Failed to add exercise. Please try again.',
    'error.exerciseRemove': 'Failed to remove exercise. Please try again.',
    'error.setAdd': 'Failed to add set. Please try again.',
    'error.setUpdate': 'Failed to update set. Please try again.',
    'error.setDelete': 'Failed to delete set. Please try again.',
    'error.workoutUpdate': 'Failed to update workout. Please try again.',
    'error.reorder': 'Failed to save exercise order. Please try again.',
    'error.numericOnly': 'Reps and weight must contain only numeric values.',
    'error.invalidSet': 'Reps must be a number greater than 0, and weight must be a valid number.'
  };

  private readonly mk: Dictionary = {
    'nav.dashboard': 'Контролна табла',
    'nav.workouts': 'Тренинзи',
    'nav.progress': 'Напредок',
    'nav.profile': 'Мој профил',
    'nav.theme.light': 'Светол режим',
    'nav.theme.dark': 'Темeн режим',
    'nav.logout': 'Одјава',
    'nav.login': 'Најава',
    'nav.signup': 'Регистрација',
    'nav.user.fallback': 'Корисник',
  
    'main.hero.title.line1': 'Следи го напредокот,',
    'main.hero.title.line2': 'Трансформирај го телото',
    'main.hero.subtitle': 'Апликација за следење тренинзи, напредок и фитнес цели.',
    'main.hero.cta.start': 'Започни',
    'main.hero.cta.more': 'Дознај повеќе',
    'main.features.title': 'Зошто да ја избереш апликацијата?',
    'main.features.subtitle': 'Сè што ти треба за успех во фитнес патувањето',
    'main.feature.logging.title': 'Евиденција на тренинзи',
    'main.feature.logging.desc': 'Лесно додавај тренинзи, вежби, серии, повторувања и тежини.',
    'main.feature.progress.title': 'Следење на напредок',
    'main.feature.progress.desc': 'Следи го напредокот со графици и статистики.',
    'main.feature.plans.title': 'Планови за тренинг',
    'main.feature.plans.desc': 'Креирај и следи сопствени планови според твоите цели.',
    'main.feature.records.title': 'Лични рекорди',
    'main.feature.records.desc': 'Следи лични рекорди и слави достигнувања.',
    'main.feature.secure.title': 'Безбедно и приватно',
    'main.feature.secure.desc': 'Твоите податоци се сигурно заштитени.',
    'main.feature.cross.title': 'Достапно на сите уреди',
    'main.feature.cross.desc': 'Пристапи до податоците било кога и било каде.',
    'main.cta.title': 'Подготвен да започнеш?',
    'main.cta.subtitle': 'Приклучи се и следи го напредокот кон твоите цели.',
    'main.cta.button': 'Започни сега',
    'main.footer': 'Апликација за следење тренинзи. Изработено со Angular и .NET',
  
    'dashboard.kicker': 'Центар за напредок',
    'dashboard.title': 'Контролна табла',
    'dashboard.subtitle': 'Преглед на статистика, клучни вежби и последни тренинзи.',
    'common.timeRange': 'Временски опсег',
    'common.retry': 'Обиди се повторно',
    'dashboard.loading': 'Се вчитува...',
    'dashboard.recent.title': 'Последни тренинзи',
    'dashboard.seeAll': 'Види ги сите',
    'dashboard.recent.empty': 'Сè уште нема тренинзи.',
    'dashboard.recent.first': 'Креирај го првиот тренинг',
    'dashboard.open': 'Отвори',
    'dashboard.snapshot.title': 'Брз преглед на перформансите',
    'dashboard.avgRepsSet': 'Просечни повторувања / серија',
    'dashboard.avgSetsWorkout': 'Просечни серии / тренинг',
    'dashboard.consistency': 'Конзистентност',
    'dashboard.activeDays': '{count} активни денови',
    'dashboard.openWorkouts': 'Прегледај тренинзи',
    'dashboard.viewProgress': 'Види напредок',
  
    'progress.kicker': 'Анализа на тренинг',
    'progress.title': 'Напредок',
    'progress.subtitle': 'Следи конзистентност, фокус на мускулни групи и долгорочен напредок.',
    'progress.loading': 'Се вчитува...',
    'progress.totalWorkouts': 'Вкупен број тренинзи',
    'progress.totalSets': 'Вкупен број серии',
    'progress.totalReps': 'Вкупен број повторувања',
    'progress.setsPerDay': 'Серии по ден',
    'progress.lastTrackedDays': 'Последни {count} активни денови',
    'progress.avgSetsWorkout': 'Просек серии по тренинг: {value}',
    'progress.emptyFrequency': 'Сè уште нема податоци.',
    'progress.bodyPartDistribution': 'Распределба по мускулни групи',
    'progress.emptyDistribution': 'Сè уште нема податоци.',
    'progress.bodyPartVolume': 'Вкупни серии по мускулна група',
    'progress.trackedSets': 'Вкупно евидентирани серии: {count}',
    'progress.emptyBodyPart': 'Сè уште нема податоци.',
    'progress.setsLogged': '{count} серии',
    'progress.trackedShare': '{count}% од вкупните серии',
  
    'workouts.kicker': 'Менаџер на тренинзи',
    'workouts.title': 'Тренинзи',
    'workouts.subtitle': 'Следи, филтрирај, дуплирај и организирај ги тренинзите.',
    'workouts.new': 'Нов тренинг',
    'common.dismiss': 'Затвори',
    'common.loading': 'Се вчитува...',
    'workouts.loading': 'Се вчитува...',
    'workouts.empty.title': 'Нема пронајдени тренинзи',
    'workouts.empty.all': 'Започни со креирање нов тренинг.',
    'workouts.empty.filtered': 'Нема тренинзи во избраниот период.',
    'workouts.empty.create': 'Креирај прв тренинг',
    'workouts.card.view': 'Кликни за детали',
    'workouts.copy': 'Дуплирај',
    'pagination.prev': 'Претходно',
    'pagination.next': 'Следно',
    'pagination.meta': 'Страница {current} од {total} • Вкупно: {count}',
    'workouts.create.title': 'Нов тренинг',
    'workouts.field.title': 'Наслов',
    'workouts.field.title.placeholder': 'пр. Push Day, Leg Day',
    'common.date': 'Датум',
    'common.cancel': 'Откажи',
    'workouts.create.action': 'Креирај',
    'workouts.delete.title': 'Избриши тренинг',
    'workouts.delete.message': 'Дали сигурно сакаш да го избришеш тренингот? Оваа акција не може да се врати.',
  
    'workoutDetail.back': 'Назад',
    'workoutDetail.kicker': 'Тренинг',
    'workoutDetail.exercisesCount': '{count} вежби',
    'workoutDetail.editWorkout': 'Измени',
    'workoutDetail.expandAll': 'Прикажи ги сите',
    'workoutDetail.collapseAll': 'Сокриј ги сите',
    'workoutDetail.addExercise': 'Додади вежба',
    'workoutDetail.loading': 'Се вчитува...',
    'workoutDetail.empty.title': 'Сè уште нема вежби',
    'workoutDetail.empty.desc': 'Додади вежба за да започнеш.',
    'workoutDetail.setsLogged': 'Внесени се {count} серии',
    'workoutDetail.dragHint': 'Повлечи за промена на редослед',
    'workoutDetail.expandExercise': 'Прикажи',
    'workoutDetail.collapseExercise': 'Сокриј',
    'workoutDetail.removeExercise': 'Отстрани',
    'workoutDetail.table.set': 'Серија',
    'workoutDetail.table.reps': 'Повторувања',
    'workoutDetail.table.weight': 'Тежина (кг)',
    'workoutDetail.table.actions': 'Акции',
    'workoutDetail.placeholder.reps': 'Повт.',
    'workoutDetail.placeholder.weight': 'Тежина',
    'workoutDetail.editSet': 'Измени',
    'workoutDetail.deleteSet': 'Избриши',
    'workoutDetail.save': 'Зачувај',
    'workoutDetail.addSet': 'Додади серија',
    'workoutDetail.searchExercise': 'Пребарај вежба',
    'workoutDetail.searchPlaceholder': 'Пребарај...',
    'workoutDetail.searching': 'Пребарување...',
    'workoutDetail.results': '{count} резултати',
    'workoutDetail.noResults': 'Нема резултати.',
    'workoutDetail.edit.title': 'Измени тренинг',
    'workoutDetail.saveChanges': 'Зачувај измени',
    'workoutDetail.removeExerciseTitle': 'Отстрани вежба',
    'workoutDetail.removeExerciseMessage': 'Дали сигурно сакаш да ја отстраниш вежбата?',
    'workoutDetail.deleteSetTitle': 'Избриши серија',
    'workoutDetail.deleteSetMessage': 'Дали сигурно сакаш да ја избришеш серијата?',
    'workoutDetail.setLabel': 'Серија {number}',
  
    'confirm.selected': 'Избрано',
    'confirm.cannotUndo': 'Оваа акција не може да се врати.',
    'confirm.delete': 'Избриши',
    'confirm.deleting': 'Се брише...',
    'confirm.defaultTitle': 'Потврда',
    'confirm.defaultMessage': 'Дали си сигурен?',
  
    'notFound.kicker': 'Грешка 404',
    'notFound.title': 'Страницата не постои',
    'notFound.desc': 'Страницата не е пронајдена или е преместена.',
    'notFound.cta': 'Назад на табла',
  
    'logout.kicker': 'Сесија',
    'logout.title': 'Успешно се одјави',
    'logout.desc': 'Можеш повторно да се најавиш во секое време.',
    'logout.cta': 'Назад во апликацијата',
  
    'range.allTime': 'Сè',
    'range.last7': '7 дена',
    'range.last14': '14 дена',
    'range.last30': '30 дена',
  
    'error.dashboardLoad': 'Не може да се вчита таблата.',
    'error.progressLoad': 'Не може да се вчита напредокот.',
    'error.workoutsLoad': 'Не може да се вчитаат тренинзите.',
    'error.filteredWorkoutsLoad': 'Не може да се вчитаат тренинзите.',
    'error.workoutCreate': 'Не успеа креирањето.',
    'error.workoutDelete': 'Не успеа бришењето.',
    'error.workoutCopy': 'Не успеа дуплирањето.',
    'error.workoutDetails': 'Не може да се вчитаат деталите.',
    'error.exerciseAdd': 'Не успеа додавањето.',
    'error.exerciseRemove': 'Не успеа отстранувањето.',
    'error.setAdd': 'Не успеа додавањето.',
    'error.setUpdate': 'Не успеа ажурирањето.',
    'error.setDelete': 'Не успеа бришењето.',
    'error.workoutUpdate': 'Не успеа ажурирањето.',
    'error.reorder': 'Не успеа зачувувањето.',
    'error.numericOnly': 'Внеси само бројки.',
    'error.invalidSet': 'Внеси валидни вредности.'
  };

  constructor(private readonly localeService: LocaleService) {}

  t(key: string, params?: Record<string, string | number>): string {
    const dict = this.localeService.locale === 'mk' ? this.mk : this.en;
    const template = dict[key] ?? this.en[key] ?? key;

    if (!params) {
      return template;
    }

    return template.replace(/\{(\w+)\}/g, (_, name: string) => String(params[name] ?? `{${name}}`));
  }

  translateBodyPart(name: string | null | undefined): string {
    if (!name) {
      return '';
    }

    if (this.localeService.locale !== 'mk') {
      return name;
    }

    const normalized = name.trim().toLowerCase();
    return this.bodyPartMk[normalized] ?? name;
  }
}
